# 経費管理アプリケーション

このアプリケーションは、PDFの領収書から情報を抽出し、経費データをJSON形式で管理するローカルアプリケーションです。

## OS互換性

- Windows 10/11: 完全サポート
- macOS 10.15以降: 開発中
- Linux: 開発中

## 機能

- PDFファイルからJSONデータの自動生成（Gemini APIを使用）
- 経費データの表形式での表示と管理
- PDFファイルの表示機能
- JSONデータの編集機能
- レコードの削除機能

## 表示項目

アプリケーションは以下の列を持つ表形式でデータを表示します：

- 月: 経費の発生月
- 日: 経費の発生日
- 経費種目: 経費の種類（例：物品費）
- 発行元: 領収書の発行者
- 品目: 購入した商品名
- 業者: 販売業者名
- 品番: 商品の型番
- 個数: 購入数量
- 領収書等: PDFファイルの情報（クリックで表示可能）
- 関連処理: 関連する処理情報
- 金額: 支払金額
- JSON: JSONファイル名（クリックで編集可能）
- 削除: レコードの削除ボタン

各セルにはコピーボタン（📋）が付いており、クリックでクリップボードにコピーできます。

## 使用方法

1. フォルダ構造を以下のように作成します：
   ```
   経費種目/
   ├── pdf/
   │   └── （PDFファイル）
   └── json/
       └── （自動生成されるJSONファイル）
   ```

2. PDFファイルを `pdf` フォルダに配置します。

3. アプリケーションを起動すると、PDFファイルから自動的にJSONファイルが生成されます。
   - JSON生成に失敗した場合は、手動でJSONボタンから編集できます。

4. 表示されたデータは以下の操作が可能です：
   - 各列のデータをクリップボードにコピー
   - PDFファイルの表示
   - JSONデータの編集
   - レコードの削除（確認ダイアログ付き）

## 環境変数の設定

### Windows

#### GUIで設定する場合
1. Windowsキー + Rを押して「実行」を開く
2. `sysdm.cpl` と入力してシステムのプロパティを開く
3. 「詳細設定」タブを選択
4. 「環境変数」ボタンをクリック
5. 「ユーザー環境変数」で「新規」をクリック
6. 変数名に `GeminiApiKey`、値にAPIキーを入力
7. 「OK」をクリックして保存

#### コマンドラインで設定する場合
PowerShellの場合:
```powershell
$env:GeminiApiKey="YOUR_API_KEY"
```

コマンドプロンプトの場合:
```cmd
set GeminiApiKey=YOUR_API_KEY
```

### macOS

#### GUIで設定する場合
1. システム環境設定を開く
2. 「セキュリティとプライバシー」を選択
3. 「プライバシー」タブを選択
4. 管理者権限で変更を許可
5. 環境変数 `GeminiApiKey` を追加し、値を設定

#### ターミナルで設定する場合
一時的な設定:
```bash
export GeminiApiKey=YOUR_API_KEY
```

永続的な設定:
```bash
echo "export GeminiApiKey=YOUR_API_KEY" >> ~/.zshrc
source ~/.zshrc
```

### Linux

一時的な設定:
```bash
export GeminiApiKey=YOUR_API_KEY
```

永続的な設定:
```bash
echo "export GeminiApiKey=YOUR_API_KEY" >> ~/.bashrc
source ~/.bashrc
```

注意: APIキーを直接コードに記述することも可能ですが、セキュリティ上推奨されません。

## 今後の予定

- macOSとLinuxのサポート強化
- 経費データの集計機能
- フォルダ毎に以下の内容を指定できるようにする
	- LLMに渡すプロンプト
	- 申請用のメタデータ
	- UIや、その後申請で利用するjsonデータ

## 議論

- 現在 pdf, jsonとフォルダを分けているが,
未処理, 処理済みとフォルダ分けして,
領収毎にフォルダを作成したほうが拡張性があるかもしれない.
ただ, 検索に時間がかかるかもしれない.
