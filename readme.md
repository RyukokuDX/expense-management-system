# 校費利用一覧app

## 概要
領収書のpdfファイルに対応するjsonファイルから
使用状況の一覧を作る

## 環境
- python
	- tkinter

## スクリプト内容

### display_json_data_gui.py
このスクリプトは、JSON ファイルからデータを読み込み、GUI で表形式に表示します。

#### 機能
- 指定されたディレクトリ内の JSON ファイルを検索
- JSON ファイルからデータを読み込み
- GUI で表形式にデータを表示
- スクロール可能なテーブル表示
- フォルダごとにタブで分けて表示
- 大きなフォントサイズで表示
- セルをクリックすると値がクリップボードにコピーされる機能

#### 関数の説明
- `list_json_files(directory)`: 指定されたディレクトリ内のすべての JSON ファイルを再帰的に検索し、そのパスのリストを返します。
- `read_json_file(file_path)`: 指定された JSON ファイルを読み込み、その内容を Python オブジェクトとして返します。
- `parse_date(date_str)`: 日付文字列を解析し、月と日を返します。複数の日付形式（`%Y/%m/%d` と `%Y-%m-%d`）を試します。解析できない場合はデフォルト値（月=1, 日=1）を返します。
- `copy_to_clipboard(text)`: 指定されたテキストをクリップボードにコピーします。
- `display_json_data_gui()`: メイン関数で、GUI ウィンドウを作成し、JSON ファイルからデータを読み込んでテーブルに表示します。フォルダごとにタブで分けて表示します。

#### 必要条件
- Python 3.6 以上
- tkinter ライブラリ（Python の標準ライブラリ）

#### 使い方
1. スクリプトを実行します：
```
python display_json_data_gui.py
```

2. GUI ウィンドウが表示され、JSON ファイルのデータが表形式で表示されます。
3. フォルダごとにタブで分けて表示されるため、異なるフォルダのデータを簡単に切り替えて閲覧できます。
4. 表のセルをクリックすると、そのセルの値がクリップボードにコピーされます。コピーが完了すると、画面下部に緑色のメッセージが表示されます。

#### JSON ファイルの形式
スクリプトは以下の形式の JSON ファイルを想定しています：

```json
{
  "title": "納品書",
  "issuer": "龍谷大学生活協同組合\n専務理事崎濱誠",
  "receiver_group": "先端理工学部",
  "receiver_name": "藤原和将",
  "total_amount": "3360",
  "payment_date": "2025/04/14",
  "items": [
    {
      "product_name": "NFCモジュール V3キット",
      "provider": "Jectse",
      "model": "XD 00228",
      "unite_price": "1680",
      "total_price": "3360",
      "number": "2",
      "delivery_date": null
    }
  ]
}
```

#### カスタマイズ
- ディレクトリを変更する場合は、`display_json_data_gui` 関数内の `directory` 変数を変更してください。
- 日付の形式が異なる場合は、`parse_date` 関数を適宜修正してください。
- フォントサイズを変更する場合は、`default_font` 変数の値を変更してください。
- コピー機能の動作を変更する場合は、`on_cell_click` 関数を修正してください。

#### エラー処理
- JSON ファイルが見つからない場合は、「JSON ファイルが見つかりません」というメッセージがテーブルに表示されます。
- JSON ファイルの形式が異なる場合は、コンソールにエラーメッセージが出力されます。
- 日付の形式が異なる場合は、デフォルト値（月=1, 日=1）が使用されます。
- 金額の表示に関するエラーを防ぐため、`total_price` の型をチェックし、適切に処理します。

#### 注意事項
- このスクリプトは、JSON ファイルの形式に依存しています。JSON ファイルの形式が異なる場合は、スクリプトを適宜修正する必要があります。
- 大量の JSON ファイルを処理する場合は、処理に時間がかかる場合があります。

## 機能
- JSONファイルのデータをスクロール可能な表形式で表示
- フォルダごとにタブで整理された表示
- セルをクリックすると値がクリップボードにコピーされる
- コピー時は緑色のメッセージで確認表示
- 領収書等の列のPDFファイルをクリックで開く
- コピーボタンは「📋」、PDFを開くボタンは「📄」の絵文字で表示
- データは日付の新しい順（降順）に自動ソート

## 使い方
1. スクリプトを実行
2. 各タブでフォルダごとのデータを確認
3. セルをクリックして値をコピー
4. 領収書等の列のPDFファイルをクリックして開く
5. コピー時は画面下部に緑色のメッセージで確認

## カスタマイズ
- `copy_to_clipboard`関数を修正して、コピーする情報を変更可能
- ボタンの絵文字は必要に応じて変更可能
- 日付のソート順は`items_data.sort`の`reverse`パラメータで変更可能
